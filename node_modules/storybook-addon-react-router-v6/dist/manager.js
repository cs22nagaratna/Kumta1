'use strict';

var managerApi = require('@storybook/manager-api');
var p = require('react');
var b = require('../package.json');
var components = require('@storybook/components');
var coreEvents = require('@storybook/core-events');
var compareVersions = require('compare-versions');
var theming = require('@storybook/theming');
var reactInspector = require('react-inspector');

function _interopDefault (e) { return e && e.__esModule ? e : { default: e }; }

var p__default = /*#__PURE__*/_interopDefault(p);
var b__default = /*#__PURE__*/_interopDefault(b);

var a="storybook/react-router-v6",c=`${a}/panel`,A="reactRouter",e={CLEAR:`${a}/clear`,NAVIGATION:`${a}/navigation`,STORY_LOADED:`${a}/story-loaded`,ROUTE_MATCHES:`${a}/route-matches`,ACTION_INVOKED:`${a}/action_invoked`,ACTION_SETTLED:`${a}/action_settled`,LOADER_INVOKED:`${a}/loader_invoked`,LOADER_SETTLED:`${a}/loader_settled`},f=b__default.default.version;function d(){let[o,r]=p.useState();p.useEffect(()=>{if(o!==void 0)return;let i=new AbortController;return fetch("https://registry.npmjs.org/storybook-addon-react-router-v6/latest",{signal:i.signal}).then(t=>t.json()).then(t=>r(t.version)).catch(()=>{}),()=>i.abort()},[o]);let s=o===void 0?void 0:compareVersions.compareVersions(o,f)===1;return {currentAddonVersion:f,latestAddonVersion:o,addonUpdateAvailable:s}}var u=theming.styled.p`
  background: #ffebba;
  padding: 5px;
  margin-top: 0;
`;var T=theming.styled.div({flex:1,padding:"0 0 0 5px"});var h=theming.styled.div({display:"flex",padding:0,borderLeft:"5px solid transparent",borderBottom:"1px solid transparent",transition:"all 0.1s",alignItems:"flex-start",whiteSpace:"pre"});var O=theming.withTheme(({theme:o,...r})=>p__default.default.createElement(reactInspector.ObjectInspector,{theme:o.addonActionsTheme||"chromeLight",...r}));var U=components.ScrollArea,D=({routerEvents:o,onClear:r})=>p__default.default.createElement(p.Fragment,null,p__default.default.createElement(N,{title:"reactRouterLogger"},o.map((s,i)=>p__default.default.createElement(h,{key:i},p__default.default.createElement(T,null,p__default.default.createElement(O,{name:W[s.type],data:s.data,showNonenumerable:!1,sortObjectKeys:!1,expandPaths:["$.routeParams","$.searchParams","$.routeMatches.*","$.routeMatches.*.*","$.matches","$.matches.*","$.matches.*.*"]}))))),p__default.default.createElement(components.ActionBar,{actionItems:[{title:"Clear",onClick:r}]})),W={[e.NAVIGATION]:"Navigate",[e.STORY_LOADED]:"Story rendered",[e.ROUTE_MATCHES]:"New route matches",[e.ACTION_INVOKED]:"Action invoked",[e.ACTION_SETTLED]:"Action settled",[e.LOADER_INVOKED]:"Loader invoked",[e.LOADER_SETTLED]:"Loader settled"},N=theming.styled(({children:o,title:r})=>p__default.default.createElement(U,{horizontal:!0,vertical:!0,title:r},o))({margin:0,padding:"10px 5px 20px"});N.displayName="Wrapper";var C=o=>{let[r,s]=p.useState([]),{latestAddonVersion:i,addonUpdateAvailable:t}=d(),n=E=>{s(y=>[...y,E]);};managerApi.useChannel({[e.ROUTE_MATCHES]:n,[e.NAVIGATION]:n,[e.STORY_LOADED]:n,[e.ACTION_INVOKED]:n,[e.ACTION_SETTLED]:n,[e.LOADER_INVOKED]:n,[e.LOADER_SETTLED]:n,[coreEvents.STORY_CHANGED]:()=>s([])});let l=()=>{o.api.emit(e.CLEAR),s([]);};return p__default.default.createElement(components.AddonPanel,{...o},p__default.default.createElement(u,null,t&&p__default.default.createElement(p__default.default.Fragment,null,"Version ",i," is now available !"," ",p__default.default.createElement("a",{href:`https://github.com/JesusTheHun/storybook-addon-react-router-v6/releases/tag/v${i}`},"Changelog"),". ",p__default.default.createElement("br",null)),"This addon has been renamed ",p__default.default.createElement("span",{style:{fontStyle:"italic"}},"storybook-addon-remix-react-router")," for its next major release, supporting Storybook 8."," ",p__default.default.createElement("a",{href:"https://github.com/JesusTheHun/storybook-addon-remix-react-router/issues/63"},"See the announcement"),"."),p__default.default.createElement(D,{routerEvents:r,onClear:l}))};function g(){let{api:o}=p.useContext(managerApi.ManagerContext),{addonUpdateAvailable:r}=d(),[s,i]=p.useState(0),t=()=>i(E=>E+1),n=()=>i(0);p.useEffect(()=>(o.on(coreEvents.STORY_CHANGED,n),o.on(e.ROUTE_MATCHES,t),o.on(e.NAVIGATION,t),o.on(e.ACTION_INVOKED,t),o.on(e.ACTION_SETTLED,t),o.on(e.LOADER_INVOKED,t),o.on(e.LOADER_SETTLED,t),o.on(e.CLEAR,n),()=>{o.off(coreEvents.STORY_CHANGED,n),o.off(e.ROUTE_MATCHES,t),o.off(e.NAVIGATION,t),o.off(e.ACTION_INVOKED,t),o.off(e.ACTION_SETTLED,t),o.off(e.LOADER_INVOKED,t),o.off(e.LOADER_SETTLED,t),o.off(e.CLEAR,n);}),[o]);let l=[];return r&&l.push("\u26A1\uFE0F"),s&&l.push(`(${s})`),p__default.default.createElement(p__default.default.Fragment,null,"React Router ",l.join(" "))}managerApi.addons.register(a,o=>{managerApi.addons.add(c,{type:managerApi.types.PANEL,paramKey:A,title:p__default.default.createElement(g,null),match:({viewMode:r})=>r==="story",render:({active:r})=>p__default.default.createElement(C,{active:r||!1,api:o,key:a})});});
//# sourceMappingURL=out.js.map
//# sourceMappingURL=manager.js.map